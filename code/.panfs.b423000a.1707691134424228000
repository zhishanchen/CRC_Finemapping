args <- commandArgs(trailingOnly=T)
input <- args[1]

inputfile1=paste0(input,".DISTAL.SCORE.txt.region.txt_HighConfidence_Gene.txt_CCV_num.txt_v2")
df <- read.table(inputfile1,header=T,sep="\t",stringsAsFactors=F)
colnames(df)[c(24,26,27)] <- c("count","indep","region")
df2 <- aggregate(df[,1]~gene+indep+region, data = df,paste0,collapse=",")
colnames(df2) <- c("gene","indep","region","ccv")
#df3 <- Reduce(function(d1, d2) merge(d1, d2, by=c("gene","indep"),all=F), list(df,df2))
write.table(df2,paste0(input,".DISTAL.SCORE.txt.region.txt_HighConfidence_Gene.txt_CCV_num.txt_v2_aggregate.txt"),row.names=F,quote=F,sep="\t")
